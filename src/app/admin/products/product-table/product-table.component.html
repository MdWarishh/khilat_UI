<!-- admin/products/product-table/product-table.component.html -->
<div class="table-card">

  <!-- Results info + page size selector -->
  <div class="table-meta">
    <span class="results-info">
      Showing {{ startIndex + 1 }}‚Äì{{ endIndex }} of {{ totalElements }} products
    </span>
    <div class="page-size-wrap">
      <span>Show</span>
      <select [ngModel]="pageSize" (ngModelChange)="onPageSizeChange.emit($event)">
        <option [value]="10">10</option>
        <option [value]="20">20</option>
        <option [value]="50">50</option>
      </select>
      <span>per page</span>
    </div>
  </div>

  <!-- Table -->
  <div class="table-wrap" *ngIf="products.length > 0">
    <table>
      <thead>
        <tr>
          <th class="sortable" (click)="onSort.emit('name')">
            Product Name
            <span class="sort-arrow" [class.active]="sortField === 'name'">
              {{ sortDir === 'asc' && sortField === 'name' ? '‚Üë' : '‚Üì' }}
            </span>
          </th>
          <th>Category</th>
          <th class="sortable" (click)="onSort.emit('price')">
            Price
            <span class="sort-arrow" [class.active]="sortField === 'price'">
              {{ sortDir === 'asc' && sortField === 'price' ? '‚Üë' : '‚Üì' }}
            </span>
          </th>
          <th class="sortable" (click)="onSort.emit('stock')">
            Stock
            <span class="sort-arrow" [class.active]="sortField === 'stock'">
              {{ sortDir === 'asc' && sortField === 'stock' ? '‚Üë' : '‚Üì' }}
            </span>
          </th>
          <th>Trending</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of products; let i = index"
            class="table-row"
            [style.animation-delay]="(i * 0.04) + 's'">

          <!-- Name + ID -->
          <td>
            <div class="name-cell">
              <span class="product-name">{{ p.name }}</span>
              <span class="product-id">#{{ p.id }}</span>
            </div>
          </td>

          <!-- Category -->
          <td>
            <span class="cat-chip"  *ngIf="p.category">{{ p.category.name }}</span>
            <span class="muted"     *ngIf="!p.category">‚Äî</span>
          </td>

          <!-- Price -->
          <td class="price-cell">‚Çπ{{ p.price | number:'1.0-0' }}</td>

          <!-- Stock -->
          <td>
            <span class="stock-chip"
                  [class.out]="p.stock === 0"
                  [class.low]="p.stock > 0 && p.stock <= 5">
              {{ p.stock === 0 ? 'Out of Stock' : p.stock }}
            </span>
          </td>

          <!-- Trending -->
          <td>
            <span class="trending-chip" [class.yes]="p.trending === 'y'">
              {{ p.trending === 'y' ? 'üî• Yes' : 'No' }}
            </span>
          </td>

          <!-- Status -->
          <td>
            <span class="status-chip" [class.active]="p.isActive">
              {{ p.isActive ? 'Active' : 'Inactive' }}
            </span>
          </td>

          <!-- Actions -->
          <td>
            <div class="action-btns">
              <button class="btn-icon view"   (click)="onView.emit(p)"      title="View Details">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                  <circle cx="12" cy="12" r="3"/>
                </svg>
              </button>
              <button class="btn-icon edit"   (click)="onEdit.emit(p)"      title="Edit">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/>
                  <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
                </svg>
              </button>
              <button class="btn-icon delete" (click)="onDelete.emit(p.id)" title="Delete">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="3 6 5 6 21 6"/>
                  <path d="M19 6l-1 14a2 2 0 01-2 2H8a2 2 0 01-2-2L5 6"/>
                  <path d="M10 11v6M14 11v6"/>
                  <path d="M9 6V4a1 1 0 011-1h4a1 1 0 011 1v2"/>
                </svg>
              </button>
            </div>
          </td>

        </tr>
      </tbody>
    </table>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="products.length === 0">
    <div class="empty-icon">üîç</div>
    <h3>No products found</h3>
    <p>Try changing your search or filters</p>
    <button class="btn-clear-filters" (click)="onClearFilters.emit()">Clear Filters</button>
  </div>

  <!-- Pagination -->
  <div class="pagination" *ngIf="totalPages > 1">
    <button class="pg-btn" (click)="onPageChange.emit(1)"              [disabled]="currentPage === 1">¬´</button>
    <button class="pg-btn" (click)="onPageChange.emit(currentPage - 1)" [disabled]="currentPage === 1">‚Äπ</button>

    <ng-container *ngFor="let pg of pageNumbers">
      <button class="pg-btn page-num"
              [class.active]="pg === currentPage"
              [class.ellipsis]="pg === -1"
              [disabled]="pg === -1"
              (click)="pg !== -1 && onPageChange.emit(pg)">
        {{ pg === -1 ? '‚Ä¶' : pg }}
      </button>
    </ng-container>

    <button class="pg-btn" (click)="onPageChange.emit(currentPage + 1)" [disabled]="currentPage === totalPages">‚Ä∫</button>
    <button class="pg-btn" (click)="onPageChange.emit(totalPages)"       [disabled]="currentPage === totalPages">¬ª</button>
  </div>

</div>