<!-- admin/products/products.component.html -->
<div class="products-page">

  <!-- ── Filters + Search + Add Button ── -->
  <app-product-filters
    [categories]="categories"
    [filters]="filters"
    (filtersChange)="onFiltersChange($event)"
    (onSearch)="onSearch()"
    (onClearSearch)="onClearSearch()"
    (onClearAll)="onClearAllFilters()"
    (onAddProduct)="openAddForm()">
  </app-product-filters>

  <!-- ── Global Error ── -->
  <div class="error-alert" *ngIf="error">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
    </svg>
    {{ error }}
    <button (click)="error = ''">✕</button>
  </div>

  <!-- ── Loading Spinner ── -->
  <div class="loading-wrap" *ngIf="loading">
    <div class="spinner"></div>
    <p>Loading products...</p>
  </div>

  <!-- ── Products Table + Pagination ── -->
  <app-product-table
    *ngIf="!loading"
    [products]="products"
    [totalElements]="totalElements"
    [startIndex]="startIndex"
    [endIndex]="endIndex"
    [currentPage]="currentPage"
    [totalPages]="totalPages"
    [pageSize]="pageSize"
    [pageNumbers]="pageNumbers"
    [sortField]="sortField"
    [sortDir]="sortDir"
    (onView)="openDetails($event)"
    (onEdit)="openEditForm($event)"
    (onDelete)="deleteProduct($event)"
    (onSort)="onSort($event)"
    (onPageChange)="onPageChange($event)"
    (onPageSizeChange)="onPageSizeChange($event)"
    (onClearFilters)="onClearAllFilters()">
  </app-product-table>

  <!-- ── Product Detail Modal ── -->
  <app-product-detail-modal
    [show]="showDetails"
    [product]="selectedProduct"
    (onClose)="showDetails = false"
    (onEdit)="openEditForm($event)">
  </app-product-detail-modal>

  <!-- ── Add / Edit Form Modal ── -->
  <app-product-form-modal
    [show]="showForm"
    [saving]="saving"
    [error]="error"
    [categories]="categories"
    [editingProduct]="editingProduct"
    (onClose)="closeForm()"
    (onSubmit)="onFormSubmit($event)">
  </app-product-form-modal>

</div>